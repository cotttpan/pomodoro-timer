(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{22:function(t,e,O){"use strict";O.d(e,"a",function(){return n});var c=O(4);const a=(t,e)=>Object.assign({},t,e);class n{constructor(t){this.state=t()}latest(){return a(this.state)}get(t){return this.state[t]}pick(t){return Object(c.i)(this.state,t)}set(t){return this.state=a(this.state,t),this.state}update(t){return this.state=a(this.state,t(this.state)),this.state}validate(t){return t(this.state)}}},25:function(t,e,O){"use strict";var c={};O.d(c,"bootEpic",function(){return W}),O.d(c,"startEpic",function(){return B}),O.d(c,"endEpic",function(){return k}),O.d(c,"tickEpic",function(){return V}),O.d(c,"pauseEpic",function(){return x}),O.d(c,"resumeEpic",function(){return J}),O.d(c,"timeupEpic",function(){return $}),O.d(c,"restEpic",function(){return q}),O.d(c,"notificationEpic",function(){return z});var a=O(109),n=O(89),o=O(65),i=O(23),T=O(4),r=O(54),E=O(1);const d=Object(E.b)("POMODORO_TIMER/INPUT/"),b=Object(E.b)("POMODORO_TIMER/OUTPUT/"),j={START:d("START"),PAUSE:d("PAUSE"),RESUME:d("RESUME"),SKIP:d("SKIP"),RESET:d("RESET")},s={BOOT:b("BOOT"),START:b("START"),END:b("END"),TICK:b("TICK"),TIMEUP:b("TIMEUP"),PAUSE:b("PAUSE"),RESUME:b("RESUME"),RESET:b("RESET"),NOTIFICATION_SEND:b("NOTIFICATION_SEND"),NOTIFICATION_CLOSE:b("NOTIFICATION_CLOSE"),CHANGE:b("CHANGE")},p={INPUT:j,OUTPUT:s};var u,P=O(15),I=O(113),N=O(170),R=O(2),_=O(112),D=O(8),A=O(45),U=O(46),S=O(64),l=O(108);!function(t){t.WORK_INTERVAL="WORK_INTERVAL",t.SHORT_BREAK_INTERVAL="SHORT_BREAK_INTERVAL",t.LONG_BREAK_INTERVAL="LONG_BREAK_INTERVAL"}(u||(u={}));const M=t=>!t.isWorking&&!t.isPausing,g=t=>t.isWorking&&!t.isPausing,C=t=>Boolean(t.isPausing),f=t=>t.isWorking&&t.left<=1e3,m=t=>{const{currentInterval:e,achieveCount:O}=t;return e!==u.WORK_INTERVAL?u.WORK_INTERVAL:0!==O&&O%t.config.LONG_BREAK_AFTER==0?u.LONG_BREAK_INTERVAL:u.SHORT_BREAK_INTERVAL},L=t=>{const e=t.toLowerCase().replace(/_|interval/g," ");return e.includes("break")?`Time to take a ${e}`:`Time to ${e}`},v=t=>Object.assign({left:0,end:0,isWorking:!1,isPausing:!1,currentInterval:null,achieveCount:0,config:{WORK_INTERVAL:15e5,SHORT_BREAK_INTERVAL:3e5,LONG_BREAK_INTERVAL:9e5,LONG_BREAK_AFTER:4}},t),h=t=>e=>{const O=null===e.currentInterval?m(e):e.currentInterval,c=e.config[O],a=t.timestamp+c,n=c;return Object.assign({},e,{currentInterval:O,end:a,left:n,isWorking:!0,isPausing:!1})},H=t=>e=>{const O=m(e),c=e.config[O],a=t.timestamp+c,n=c;return Object.assign({},e,{currentInterval:O,end:a,left:n,isWorking:!1,isPausing:!1})},G=t=>e=>{const O=Math.max(0,e.end-t.timestamp);return Object.assign({},e,{left:O})},w=t=>{return Object.assign({},t,{isWorking:!1,isPausing:!0})},y=t=>e=>{const O=t.timestamp+e.left,c=Math.max(0,O-t.timestamp);return Object.assign({},e,{end:O,left:c,isWorking:!0,isPausing:!1})},K=t=>{const e=t.currentInterval===u.WORK_INTERVAL?t.achieveCount+1:t.achieveCount;return Object.assign({},t,{achieveCount:e,isWorking:!1,isPausing:!1})},F=t=>{const e=t.achieveCount;return v({achieveCount:e})},W=(t,e)=>Object(i.a)(s.BOOT(e.repo.latest())),B=(t,{repo:e})=>Object(E.d)(t,j.START).pipe(Object(D.a)(()=>e.validate(M)),Object(R.a)(()=>e.update(h({timestamp:Date.now()}))),Object(R.a)(s.START)),k=(t,{repo:e})=>{const O=Object(E.d)(t,j.SKIP),c=Object(E.d)(t,s.TIMEUP);return Object(P.a)(O,c).pipe(Object(R.a)(()=>e.update(H({timestamp:Date.now()}))),Object(R.a)(s.END))},V=(t,{repo:e})=>{const O=Object(E.d)(t,s.START),c=Object(E.d)(t,s.RESUME),a=Object(E.d)(t,s.PAUSE),n=Object(E.d)(t,j.SKIP),o=Object(E.d)(t,s.TIMEUP),i=Object(E.d)(t,s.RESET),T=Object(P.a)(a,n,o,i);return Object(P.a)(O,c).pipe(Object(A.a)(()=>Object(N.a)(100,1e3).pipe(Object(_.a)(T))),Object(R.a)(()=>e.update(G({timestamp:Date.now()}))),Object(R.a)(s.TICK))},x=(t,{repo:e})=>Object(E.d)(t,j.PAUSE).pipe(Object(D.a)(()=>e.validate(g)),Object(R.a)(()=>e.update(w)),Object(R.a)(s.PAUSE)),J=(t,{repo:e})=>Object(E.d)(t,j.RESUME).pipe(Object(D.a)(()=>e.validate(C)),Object(R.a)(()=>e.update(y({timestamp:Date.now()}))),Object(R.a)(s.RESUME)),$=(t,{repo:e})=>Object(E.d)(t,s.TICK).pipe(Object(D.a)(()=>e.validate(f)),Object(R.a)(()=>e.update(K)),Object(R.a)(s.TIMEUP)),q=(t,{repo:e})=>Object(E.d)(t,j.RESET).pipe(Object(R.a)(()=>e.update(F)),Object(R.a)(s.RESET)),z=(t,e)=>{const O=Object(E.d)(t,s.TIMEUP).pipe(Object(A.a)(()=>Object(E.d)(t,s.END).pipe(Object(l.a)(1))),Object(R.a)(t=>t.payload.currentInterval),Object(D.a)(T.b),Object(R.a)(L),Object(R.a)(t=>e.sendNotification("PomodoroTimer",{body:t})),Object(S.a)());return Object(P.a)(O.pipe(Object(R.a)(()=>s.NOTIFICATION_SEND(e.repo.latest()))),O.pipe(Object(A.a)(O=>Object(I.a)(O,"click").pipe(Object(_.a)(Object(E.d)(t,[s.START,s.RESUME])),Object(U.a)(()=>O.close()),Object(R.a)(()=>s.NOTIFICATION_CLOSE(e.repo.latest()))))))};const Q=t=>(X=Math.max(0,t),Y="0",Z=2,(Y+X).slice(-Z));var X,Y,Z;const tt=t=>{const e=Math.floor(t/1e3/60/60)%60,O=Math.floor(t/1e3/60)%60,c=Math.floor(t/1e3)%60;return Object(T.g)({hour:e,min:O,sec:c},Q)};var et=O(22);const Ot=()=>new et.a(v);O.d(e,"c",function(){return ct}),O.d(e,!1,function(){return u}),O.d(e,!1,function(){return M}),O.d(e,!1,function(){return g}),O.d(e,!1,function(){return C}),O.d(e,!1,function(){return f}),O.d(e,!1,function(){return m}),O.d(e,!1,function(){return L}),O.d(e,!1,function(){return v}),O.d(e,!1,function(){return h}),O.d(e,!1,function(){return H}),O.d(e,!1,function(){return G}),O.d(e,!1,function(){return w}),O.d(e,!1,function(){return y}),O.d(e,!1,function(){return K}),O.d(e,!1,function(){return F}),O.d(e,"d",function(){return tt}),O.d(e,"b",function(){return Ot}),O.d(e,"a",function(){return p});const ct=Object(r.a)(Object(T.j)(c),(t,e)=>t.pipe(Object(n.a)(t=>Object(i.a)(t,s.CHANGE(e.repo.latest()))),Object(a.a)(o.a)))},5:function(t,e,O){"use strict";O.r(e);var c={};O.d(c,"bootEpic",function(){return L}),O.d(c,"addTodoEpic",function(){return v}),O.d(c,"deleteTodoEpic",function(){return h}),O.d(c,"updateEpic",function(){return H});var a=O(15),n=O(1),o=O(2),i=O(22);const T=Object(n.b)("APP_SESSION/INPUT/"),r=Object(n.b)("APP_SESSION/OUTPUT/"),E={INPUT:{PATCH:T("PATCH")},OUTPUT:{CHANGE:r("CHANGE")}};var d=O(25),b=O(109),j=O(89),s=O(65),p=O(28),u=O(4),P=O(54),I=O(23),N=O(8),R=O(46),_=O(47),D=O(66);const A=t=>t.content.trim().length>0,U=t=>Object.assign({},t,{updatedAt:Date.now()}),S=()=>({}),l=t=>e=>Object.assign({},e,{[t.id]:t}),M=Object(n.b)("TODO/INPUT/"),g=Object(n.b)("TODO/OUTPUT/"),C={ADD:M("ADD"),DELETE:M("DELETE"),UPDATE:M("UPDATE"),INCREMENT_MILESTONE:M("INCREMENT_MILESTONE"),TOGGLE_COMPLETION:M("TOGGLE_COMPLETION")},f={BOOT:g("BOOT"),ADD:g("ADD"),UPDATE:g("UPDATE"),DELETE:g("DELETE"),CHANGE:g("CHANGE"),ERROR:g("ERROR")},m={INPUT:C,OUTPUT:f},L=(t,e)=>Object(p.a)(e.getAllUnCompletedTodos()).pipe(Object(o.a)(t=>e.repo.update((t=>e=>Object.assign({},e,Object(u.f)(t,"id")))(t))),Object(o.a)(f.BOOT),Object(D.a)(()=>Object(I.a)(f.ERROR({message:"Failed to initial fetch..."})))),v=(t,e)=>Object(n.d)(t,C.ADD).pipe(Object(o.a)(t=>t.payload),Object(N.a)(A),Object(o.a)(t=>(t=>({id:-1,content:t,completed:!1,milestone:0,createdAt:Date.now(),updatedAt:Date.now()}))(t.content)),Object(_.a)(t=>Object(p.a)(e.addTodo(t)).pipe(Object(R.a)(t=>e.repo.update(l(t))),Object(o.a)(f.ADD),Object(D.a)(()=>Object(I.a)(f.ERROR({message:"Failed to add todo..."})))))),h=(t,e)=>Object(n.d)(t,C.DELETE).pipe(Object(o.a)(t=>e.repo.get(t.payload.id+"")),Object(N.a)(u.b),Object(_.a)(t=>Object(p.a)(e.deleteTodo(t)).pipe(Object(R.a)(t=>e.repo.update((t=>e=>Object(u.h)(e,t.id+""))(t))),Object(o.a)(f.DELETE),Object(D.a)(()=>Object(I.a)(f.ERROR({message:"Failed to delete todo..."})))))),H=(t,e)=>{return Object(a.a)(Object(n.d)(t,C.UPDATE).pipe(Object(o.a)(t=>t.payload),Object(N.a)(A),Object(j.a)(t=>Object(I.a)(e.repo.get(t.id+"")).pipe(Object(N.a)(u.b),Object(o.a)(e=>U(Object.assign({},e,{content:t.content})))))),Object(n.d)(t,C.INCREMENT_MILESTONE).pipe(Object(o.a)(t=>e.repo.get(t.payload.id+"")),Object(N.a)(u.b),Object(o.a)(t=>U(Object.assign({},t,{milestone:t.milestone+1})))),Object(n.d)(t,C.TOGGLE_COMPLETION).pipe(Object(o.a)(t=>e.repo.get(t.payload.id+"")),Object(N.a)(u.b),Object(o.a)(t=>U(Object.assign({},t,{completed:!t.completed}))))).pipe(Object(_.a)(t=>Object(p.a)(e.updateTodo(t)).pipe(Object(R.a)(t=>e.repo.update(l(t))),Object(o.a)(f.UPDATE),Object(D.a)(()=>Object(I.a)(f.ERROR({message:"Failed to update todo..."}))))))};var G=O(172);const w=Object(n.b)("TODO_FORM/INPUT/"),y=Object(n.b)("TODO_FORM/OUTPUT/"),K={INPUT:{PATCH:w("PATCH")},OUTPUT:{CHANGE:y("CHANGE")}},F=()=>({appSession:(()=>new i.a(()=>({})))(),pomodoroTimer:Object(d.b)(),todo:(()=>new i.a(S))(),todoForm:(()=>new i.a(Object(u.a)({})))()}),W=Object(n.b)("INTENT/"),B={POMODORO_TIMER_START:W("POMODORO_TIMER_START"),POMODORO_TIMER_PAUSE:W("POMODORO_TIMER_PAUSE"),POMODORO_TIMER_RESUME:W("POMODORO_TIMER_RESUME"),POMODORO_TIMER_SKIP:W("POMODORO_TIMER_SKIP"),POMODORO_TIMER_RESET:W("RESET"),INPUT_NEW_TODO_CONTENT:W("INPUT_NEW_TODO_CONTENT"),INPUT_ENDIT_TODO_CONTENT:W("INPUT_ENDIT_TODO_CONTENT"),SHOW_TODO_EDIT_FORM:W("SHOW_TODO_EDIT_FORM"),CLOSE_TODO_EDIT_FORM:W("CLOSE_TODO_EDIT_FORM"),ADD_NEW_TODO:W("ADD_TODO"),DELETE_TODO:W("DELETE_TODO"),UPDATE_TODO_CONTENT:W("UPDATE_TODO"),TOGGLE_TODO_COMPLETION:W("COMPLETE_TODO"),CLEAN_COMPLETED_TODOS:W("CLEAN_COMPLETED_TODOS")};var k=O(103);var V=function(t,e,O,c){return new(O||(O=Promise))(function(a,n){function o(t){try{T(c.next(t))}catch(t){n(t)}}function i(t){try{T(c.throw(t))}catch(t){n(t)}}function T(t){t.done?a(t.value):new O(function(e){e(t.value)}).then(o,i)}T((c=c.apply(t,e||[])).next())})};const x=t=>({getAllUnCompletedTodos(){return t.transaction("r",t.todos,()=>V(this,void 0,void 0,function*(){return t.todos.toCollection().filter(t=>!Boolean(t.completed)).sortBy("updatedAt")}))},addTodo(e){return t.transaction("rw",t.todos,()=>V(this,void 0,void 0,function*(){const O=yield t.todos.put(Object(u.h)(e,"id"));return t.todos.get(O)}))},updateTodo(e){return t.transaction("rw",t.todos,()=>V(this,void 0,void 0,function*(){return yield t.todos.put(e),e}))},deleteTodo(e){return t.transaction("rw",t.todos,()=>V(this,void 0,void 0,function*(){return yield t.todos.delete(e.id),e}))}}),J={};const $=()=>new class extends k.a{constructor(t={}){super("PomodoroTimerDB",t),this.version(1).stores({todos:"++id,createdAt,updatedAt"})}}(J),q=(t,e)=>((t,e)=>Object(n.d)(t,E.INPUT.PATCH).pipe(Object(o.a)(t=>t.payload),Object(o.a)(t=>e.repo.update(t)),Object(o.a)(E.OUTPUT.CHANGE)))(((t,e)=>Object(a.a)(Object(n.d)(t,B.POMODORO_TIMER_START).pipe(Object(o.a)(t=>String(t.payload.todoId)),Object(o.a)(t=>e.todo.get(t)),Object(N.a)(u.b),Object(o.a)(t=>E.INPUT.PATCH(e=>Object.assign({},e,{currentTimerTarget:t})))),Object(n.d)(t,B.POMODORO_TIMER_RESET).pipe(Object(o.a)(()=>E.INPUT.PATCH(t=>Object.assign({},t,{currentTimerTarget:void 0})))),Object(n.d)(t,m.OUTPUT.CHANGE).pipe(Object(o.a)(()=>e.appSession.get("currentTimerTarget")),Object(o.a)(t=>t?String(t.id):""),Object(o.a)(t=>e.todo.get(t)),Object(o.a)(t=>E.INPUT.PATCH(e=>Object.assign({},e,{currentTimerTarget:t}))))))(t,e),{repo:e.appSession});var z=O(37);var Q=O(108),X=O(45);const Y=(t,e,O)=>{const i=Object.assign({repo:e.todo},O),T=Object(a.a)(Object(n.d)(t,B.ADD_NEW_TODO).pipe(Object(o.a)(t=>m.INPUT.ADD(t.payload))),Object(n.d)(t,B.UPDATE_TODO_CONTENT).pipe(Object(o.a)(t=>m.INPUT.UPDATE(t.payload))),Object(n.d)(t,B.DELETE_TODO).pipe(Object(o.a)(t=>m.INPUT.DELETE(t.payload))),Object(n.d)(t,B.TOGGLE_TODO_COMPLETION).pipe(Object(o.a)(t=>m.INPUT.TOGGLE_COMPLETION(t.payload))),Object(n.d)(t,d.a.OUTPUT.TIMEUP).pipe(Object(X.a)(()=>Object(n.d)(t,d.a.OUTPUT.END).pipe(Object(Q.a)(1),Object(o.a)(()=>e.appSession.get("currentTimerTarget")),Object(N.a)(u.b),Object(o.a)(t=>m.INPUT.INCREMENT_MILESTONE({id:t.id}))))));return t=T,O=i,Object(P.a)(Object(u.j)(c))(t,O).pipe(Object(j.a)(t=>Object(p.a)([t,f.CHANGE(O.repo.latest())])),Object(b.a)(s.a))};var Z,tt;const et=(t,e)=>{return((t,e)=>Object(n.d)(t,K.INPUT.PATCH).pipe(Object(o.a)(t=>t.payload),Object(G.a)(10),Object(o.a)(t=>e.repo.update(t)),Object(o.a)(K.OUTPUT.CHANGE)))(Object(a.a)(Object(n.d)(t,B.INPUT_NEW_TODO_CONTENT).pipe(Object(o.a)(t=>t.payload),Object(o.a)(t=>K.INPUT.PATCH(e=>Object.assign({},e,{newEntryTodoContent:t})))),Object(n.d)(t,m.OUTPUT.ADD).pipe(Object(o.a)(()=>K.INPUT.PATCH(t=>Object.assign({},t,{newEntryTodoContent:void 0})))),Object(n.d)(t,[B.INPUT_ENDIT_TODO_CONTENT,B.SHOW_TODO_EDIT_FORM]).pipe(Object(o.a)(t=>t.payload),Object(o.a)(t=>K.INPUT.PATCH(e=>Object.assign({},e,{editingTodoId:t.id,editingTodoContent:t.content})))),Object(n.d)(t,[B.CLOSE_TODO_EDIT_FORM,m.OUTPUT.UPDATE]).pipe(Object(o.a)(t=>t.payload),Object(o.a)(()=>K.INPUT.PATCH(t=>Object.assign({},t,{editingTodoId:void 0,editingTodoContent:void 0})))),Object(n.d)(t,[m.OUTPUT.DELETE]).pipe(Object(o.a)(t=>t.payload),Object(N.a)(t=>e.todoForm.validate(e=>e.editingTodoId===t.id)),Object(o.a)(()=>K.INPUT.PATCH(t=>Object.assign({},t,{editingTodoId:void 0,editingTodoContent:void 0}))))),{repo:e.todoForm})};O.d(e,"service",function(){return Ot}),O.d(e,"createRepsitoryGroup",function(){return F}),O.d(e,"INTENTS",function(){return B}),O.d(e,"APP_SESSION",function(){return E}),O.d(e,"POMODORO_TIMER",function(){return d.a}),O.d(e,"TODO",function(){return m}),O.d(e,"TODO_FORM",function(){return K});const Ot=t=>{const e=(t=>Object.assign({},x(t)))($()),O=F();return Object(a.a)(q(t,O),((t,e,O={Notification:Notification})=>{const c={repo:e.pomodoroTimer,sendNotification:(t,e)=>new O.Notification(t,e)},i=Object(a.a)(Object(n.d)(t,B.POMODORO_TIMER_START).pipe(Object(N.a)(()=>e.appSession.validate(t=>void 0!=t.currentTimerTarget)),Object(z.a)(d.a.INPUT.START())),Object(n.d)(t,B.POMODORO_TIMER_PAUSE).pipe(Object(z.a)(d.a.INPUT.PAUSE())),Object(n.d)(t,B.POMODORO_TIMER_RESUME).pipe(Object(z.a)(d.a.INPUT.RESUME())),Object(n.d)(t,B.POMODORO_TIMER_SKIP).pipe(Object(N.a)(()=>e.appSession.validate(t=>!!t.currentTimerTarget)),Object(z.a)(d.a.INPUT.SKIP())),Object(n.d)(t,B.POMODORO_TIMER_RESET).pipe(Object(z.a)(d.a.INPUT.RESET())),Object(n.d)(t,B.CLEAN_COMPLETED_TODOS).pipe(Object(o.a)(()=>e.appSession.get("currentTimerTarget")),Object(N.a)(u.b),Object(o.a)(t=>e.todo.get(t.id+"")),Object(N.a)(u.b),Object(N.a)(t=>t.completed),Object(z.a)(d.a.INPUT.RESET())),Object(n.d)(t,Object(u.j)(d.a.OUTPUT)));return Object(d.c)(i,c)})(t,O),Y(t,O,e),et(t,O))}},54:function(t,e,O){"use strict";O.d(e,"a",function(){return a});var c=O(15);function a(t,e){return(O,a)=>{const n=t.map(t=>t(O,a)),o=Object(c.a)(...n);return e?o.pipe(t=>e(t,a)):o}}}}]);